<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Scratch WebGL rendering demo</title>
</head>
<body>
<canvas id="scratch-stage" width="10" height="10" style="border:1px dashed black; margin-top: 9px;"></canvas>
<p>
    <input type="range" id="fudge" style="width:50%" value="90" min="-90" max="270" step="any" oninput="onFudgeChanged(this.value)" onchange="onFudgeChanged(this.value)">
</p>
<p>
    Min: <input id="fudgeMin" type="number" onchange="onFudgeMinChanged(this.value)">
    Max: <input id="fudgeMax" type="number" onchange="onFudgeMaxChanged(this.value)">
</p>
</body>
<script src="render-webgl.js"></script>
<script>
    var canvas = document.getElementById('scratch-stage');
    var renderer = new RenderWebGL(canvas);
    var drawableID = renderer.createDrawable();
    var direction = 90;
    window.fudge = 90;

    var fudgeInput = document.getElementById('fudge');
    function onFudgeMinChanged(newValue) {
        fudgeInput.min = newValue;
    }
    function onFudgeMaxChanged(newValue) {
        fudgeInput.max = newValue;
    }
    function onFudgeChanged(newValue) {
        window.fudge = newValue;
    }

    canvas.onclick = function(event) {
        var x = event.pageX - canvas.offsetLeft;
        var y = event.pageY - canvas.offsetTop;
        var pickID = renderer.pick(x,y);
        console.log('You clicked on ' + (pickID < 0 ? 'nothing' : 'ID# ' + pickID));
    };

    function drawStep() {
        renderer.draw();
        requestAnimationFrame(drawStep);
    }
    function thinkStep() {
        //direction += 0.1;

        var props = {};
        //props.position = [posX, posY];
        props.direction = fudge;
        //props.pixelate = fudge;
        //props.scale = 100;

        renderer.updateDrawableProperties(drawableID, props);
    }

    renderer.updateDrawableProperties(drawableID, {
        position: [0, 0],
        scale: 100,
        direction: 90
    });

    drawStep();
    setInterval(thinkStep, 1/60);
</script>
</html>